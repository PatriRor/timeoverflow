<div>
  <h1>{{ t("Users") }} <small>({{ users.length }})</small></h1>
  <div class='navbar'>
    <div class='navbar-inner'>
      <ul class='nav pull-right'>
        <button class='btn' ng-click='show.by=null' ng-class="{active: show.by==null}">{{ t("By user") }}</button>
        <button class='btn' ng-click='show.by="category"' ng-class="{active: show.by=='category'}">{{ t("By category") }}</button>
        <a class='btn btn-primary' href='#/users/new'>{{ t("New user") }}</a>
      </ul>
    </div>
  </div>
  <ng:switch on="show.by">
    <div ng-switch-when="category">
      <table class='table table-hover table-condensed'>
        <thead>
          <tr>
            <th>{{ t("Category") }}</th>
            <th>{{ t("Members") }}</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="cat in (categories | orderBy:'fqn')" ng-show="showCat(cat.id)">
            <td>
              <span ng-repeat="t in depth(cat, true)">
                <i class="icon-angle-right"></i>
              </span>
              {{ cat.name }}
            </td>
            <td>
              <span ng-repeat="u in usersByCategory[cat.id]">{{ User.identityMap[u].registration_number }} <span ng-show="currentUser.superadmin &amp;&amp; User.identityMap[u].organization">({{ User.identityMap[u].organization.name }})</span><span ng-hide="$last">, </span></span>
            </td>
          </tr>
        </tbody>
      </table>
<!--       <div ng-repeat="cat in (categories | orderBy:'fqn')">
        <div ng-show="usersByCategory[cat.id]">
          <h5><span ng-repeat="depth(cat, true)"><i class="icon-chevron-right"></i></span> {{ cat.name }}</h5>
          <span ng-repeat="u in usersByCategory[cat.id]">{{ User.identityMap[u].registration_number }} <span ng-show="currentUser.superadmin &amp;&amp; User.identityMap[u].organization">({{ User.identityMap[u].organization.name }})</span><span ng-hide="$last">, </span></span>
        </div>
      </div>
 -->    </div>
    <div ng-switch-default="">
      <table class='table table-hover table-condensed'>
        <thead>
          <tr>
            <th colspan='12'>
            </th>
          </tr>
          <tr>
            <th ng-show="currentUser.superadmin">{{ t("Organization") }}</th>
            <th>{{ t("Member Code") }}</th>
            <th>{{ t("Name") }}</th>
            <th>{{ t("E-mail") }}</th>
            <th>{{ t("Phone") }}</th>
            <th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="u in (users | orderBy:'registration_number' | filter:searchTerm)">
            <td ng-show="currentUser.superadmin">{{ u.organization.name }}</td>
            <td>{{ u.registration_number }}</td>
            <td>{{ u.username }}</td>
            <td>{{ u.email }}</td>
            <td>{{ u.phone }}</td>
            <td class="hover-actions">
              <a class="action" href='#/users/{{u.id}}'><i class="icon-eye-open"></i>{{ t("View") }}</a>
              <a class="action" href='#/users/{{u.id}}/edit'><i class="icon-pencil"></i>{{ t("Edit") }}</a>
          </tr>
        </tbody>
      </table>
    </div>
  </ng:switch>
</div>
